id: yealink-auth-default-login

info:
  name: Yealink IP Phone Login Default Credentials
  author: naures
  severity: low
  description: |
    Attempts authentication using default credentials (admin:admin)
    and matches a successful login response.
  tags: auth,default-creds,api

requests:
  - method: POST
    path:
      - "{{BaseURL}}/api/auth/login"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:147.0) Gecko/20100101 Firefox/147.0
      Accept: application/json, text/plain, */*
      Accept-Language: en-US,en;q=0.9
      Content-Type: application/x-www-form-urlencoded
      Origin: "{{BaseURL}}"
      Referer: "{{BaseURL}}/"

    body: "username=admin&pwd=admin"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - '"ret":"ok"'
          - '"data":true'
